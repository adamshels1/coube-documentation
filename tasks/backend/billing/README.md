# –ó–∞–¥–∞—á–∞: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –±–∏–ª–ª–∏–Ω–≥–∞ –Ω–∞ –±–∞–∑–µ Kill Bill

## –û–±–∑–æ—Ä –∑–∞–¥–∞—á–∏

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –±–∏–ª–ª–∏–Ω–≥–∞ –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Coube —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Kill Bill –≤ –∫–∞—á–µ—Å—Ç–≤–µ –±–∏–ª–ª–∏–Ω–≥–æ–≤–æ–≥–æ —è–¥—Ä–∞. –°–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—é —á–µ—Ä–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏ (–¥–ª—è –ó–∞–∫–∞–∑—á–∏–∫–æ–≤) –∏ –∞–≥–µ–Ω—Ç—Å–∫—É—é –º–æ–¥–µ–ª—å —Å –∫–æ–º–∏—Å—Å–∏–µ–π 5% (–¥–ª—è –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π).

**üéØ –ö–ª—é—á–µ–≤—ã–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª–∞:**
- –í–∑–∞–∏–º–æ—Ä–∞—Å—á—ë—Ç—ã –º–µ–∂–¥—É –ó–∞–∫–∞–∑—á–∏–∫–æ–º –∏ –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º ‚Äî –Ω–∞–ø—Ä—è–º—É—é (–ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç)
- –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –≤–µ–¥—ë—Ç –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Å–ø–∏—Å—ã–≤–∞–µ—Ç –∫–æ–º–∏—Å—Å–∏—é/–ø–æ–¥–ø–∏—Å–∫—É
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ "–Ω–æ–≤—ã—Ö" –∏ "—Å—Ç–∞—Ä—ã—Ö" –∫–ª–∏–µ–Ω—Ç–æ–≤ (–ø—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥ vs –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è)
- –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏ (–∞–≥–µ–Ω—Ç—Å–∫–∞—è –º–æ–¥–µ–ª—å)
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (—Å—á–µ—Ç–∞, –ê–í–†, –∞–∫—Ç—ã)

## –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è

### 1. –ú–æ–¥–µ–ª—å 2A ‚Äî –ü–æ–¥–ø–∏—Å–∫–∞ (–ó–∞–∫–∞–∑—á–∏–∫–∏)
- –ï–∂–µ–º–µ—Å—è—á–Ω–∞—è –æ–ø–ª–∞—Ç–∞ –∑–∞ –¥–æ—Å—Ç—É–ø –∫ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
- –°–ø–∏—Å–∞–Ω–∏–µ —Å –±–∞–ª–∞–Ω—Å–∞ –∫–ª–∏–µ–Ω—Ç–∞
- –ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥ –¥–ª—è –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤ (1 –º–µ—Å—è—Ü)
- –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ –≤ –õ–ö

### 2. –ú–æ–¥–µ–ª—å 2B ‚Äî –ê–≥–µ–Ω—Ç—Å–∫–∞—è –º–æ–¥–µ–ª—å (–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏)
- –ö–æ–º–∏—Å—Å–∏—è 5% –æ—Ç —Å—É–º–º—ã –∑–∞—è–≤–∫–∏
- –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∞–Ω–∏–∏ –∑–∞—è–≤–∫–∏
- –ó–∞—á–∏—Å–ª–µ–Ω–∏–µ –Ω–∞ –±–∞–ª–∞–Ω—Å –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –ø—Ä–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–∏
- –ï–∂–µ–º–µ—Å—è—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ê–í–†

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê        REST API         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Coube Platform ‚îÇ ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫ ‚îÇ   Kill Bill      ‚îÇ
‚îÇ    (Backend)    ‚îÇ                          ‚îÇ   (Billing Core) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                                            ‚îÇ
         ‚îÇ                                            ‚îÇ
    PostgreSQL                                  PostgreSQL
   (Platform DB)                                (Billing DB)
```

**–í–∞–∂–Ω–æ**: –û—Ç–¥–µ–ª—å–Ω—ã–µ –ë–î –¥–ª—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –∏ –±–∏–ª–ª–∏–Ω–≥–∞ –¥–ª—è —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

### –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
1. **00-SUMMARY.md** - –°–≤–æ–¥–∫–∞ –ø–æ –≤—Å–µ–º—É –ø—Ä–æ–µ–∫—Ç—É –±–∏–ª–ª–∏–Ω–≥–∞
2. **01-database-schema.md** - –°—Ö–µ–º–∞ –ë–î –¥–ª—è –±–∏–ª–ª–∏–Ω–≥–∞ –≤ Coube
3. **02-killbill-setup.md** - –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Kill Bill
4. **03-integration-layer.md** - –°–ª–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Platform ‚Üî Kill Bill

### –≠—Ç–∞–ø 2: API –∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
4. **04-api-accounts.md** - API —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∏–ª–ª–∏–Ω–≥-–∞–∫–∫–∞—É–Ω—Ç–∞–º–∏
5. **05-api-subscriptions.md** - API –ø–æ–¥–ø–∏—Å–æ–∫ –¥–ª—è –ó–∞–∫–∞–∑—á–∏–∫–æ–≤
6. **06-api-commissions.md** - API —Ä–µ–∑–µ—Ä–≤–æ–≤ –∏ –∫–æ–º–∏—Å—Å–∏–π –¥–ª—è –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π
7. **07-api-invoices.md** - API —Å—á–µ—Ç–æ–≤ –∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
8. **08-api-payments.md** - API –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π (webhook –æ—Ç PSP)

### –≠—Ç–∞–ø 3: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ –¥–æ–∫—É–º–µ–Ω—Ç—ã
9. **09-daily-jobs.md** - –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ (–∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
10. **10-document-generation.md** - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (–ê–í–†, —Å—á–µ—Ç–∞)
11. **11-notifications.md** - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –±–∞–ª–∞–Ω—Å–µ –∏ –ø–ª–∞—Ç–µ–∂–∞—Ö
12. **12-admin-panel.md** - –ê–¥–º–∏–Ω–∫–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–∞—Ä–∏—Ñ–∞–º–∏

### –≠—Ç–∞–ø 4: –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ
13. **13-security.md** - –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (mTLS, JWT, –ø–æ–¥–ø–∏—Å—å webhook)
14. **14-docker-compose.md** - Docker Compose –¥–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è
15. **15-testing-strategy.md** - –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
16. **16-implementation-checklist.md** - –ß–µ–∫–ª–∏—Å—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

## –ò—Å—Ç–æ—á–Ω–∏–∫–∏

- **–¢–ó**: `/coube-documentation/business_analysis/converted/–ë–∏–ª–ª–∏–Ω–≥_v.md`
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ë–î**: `/coube-documentation/database-architecture/database-architecture-auto-generated.md`
- **Kill Bill**: https://github.com/killbill/killbill
- **–¢–µ–∫—É—â–∏–µ —Å—Ö–µ–º—ã**: `user`, `applications`, `factoring`, `invoices`

## –ö–ª—é—á–µ–≤—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏

### –í Kill Bill
- **Account** - –ë–∏–ª–ª–∏–Ω–≥-–∞–∫–∫–∞—É–Ω—Ç –∫–ª–∏–µ–Ω—Ç–∞
- **Subscription** - –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ç–∞—Ä–∏—Ñ
- **Invoice** - –°—á—ë—Ç –Ω–∞ –æ–ø–ª–∞—Ç—É
- **Payment** - –ü–ª–∞—Ç—ë–∂
- **Plan** - –¢–∞—Ä–∏—Ñ–Ω—ã–π –ø–ª–∞–Ω

### –í Coube Platform (–Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã)
- **billing.account** - –°–≤—è–∑—å —Å Kill Bill –∞–∫–∫–∞—É–Ω—Ç–æ–º
- **billing.reservation** - –†–µ–∑–µ—Ä–≤—ã –∫–æ–º–∏—Å—Å–∏–∏ (–∞–≥–µ–Ω—Ç—Å–∫–∞—è –º–æ–¥–µ–ª—å)
- **billing.transaction** - –ü—Ä–æ–≤–æ–¥–∫–∏ –∏ –æ–ø–µ—Ä–∞—Ü–∏–∏
- **billing.balance_history** - –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
- **billing.document** - –î–æ–∫—É–º–µ–Ω—Ç—ã (–ê–í–†, —Å—á–µ—Ç–∞, –∞–∫—Ç—ã)

## –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å—Å—ã

### –î–ª—è –ó–∞–∫–∞–∑—á–∏–∫–∞ (–ü–æ–¥–ø–∏—Å–∫–∞)
1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –±–∏–ª–ª–∏–Ω–≥-–∞–∫–∫–∞—É–Ω—Ç–∞
2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ new/old –∫–ª–∏–µ–Ω—Ç–∞ ‚Üí –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ —Ç–∞—Ä–∏—Ñ–∞
3. –ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥ / –æ–ø–ª–∞—Ç–∞ –ø–æ–¥–ø–∏—Å–∫–∏
4. –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è –∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è (daily_cost = monthly_fee / days_in_month)
5. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –Ω–∏–∑–∫–æ–º –±–∞–ª–∞–Ω—Å–µ
6. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–º –±–∞–ª–∞–Ω—Å–µ

### –î–ª—è –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è (–ê–≥–µ–Ω—Ç—Å–∫–∞—è –º–æ–¥–µ–ª—å)
1. –ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ –∑–∞—è–≤–∫–∏ ‚Üí —Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ 5% –∫–æ–º–∏—Å—Å–∏–∏
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ (available_balance >= commission)
3. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏ ‚Üí capture —Ä–µ–∑–µ—Ä–≤–∞
4. –û—Ç–º–µ–Ω–∞ –∑–∞—è–≤–∫–∏ ‚Üí release/–≤–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —É—Å–ª–æ–≤–∏–π)
5. –ï–∂–µ–º–µ—Å—è—á–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ê–í–†

### –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
1. –ö–ª–∏–µ–Ω—Ç –Ω–∞–∂–∏–º–∞–µ—Ç "–ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å"
2. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—á—ë—Ç–∞ (PDF)
3. –û–ø–ª–∞—Ç–∞ —á–µ—Ä–µ–∑ –±–∞–Ω–∫ / –æ–Ω–ª–∞–π–Ω (BCC, Jusan)
4. Webhook –æ—Ç PSP ‚Üí —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
5. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ê–í–† –æ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏ —Å—Ä–µ–¥—Å—Ç–≤

## –°—Ç–∞—Ç—É—Å—ã –∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è

### –°—Ç–∞—Ç—É—Å –±–∏–ª–ª–∏–Ω–≥-–∞–∫–∫–∞—É–Ω—Ç–∞
- `active` - –ê–∫—Ç–∏–≤–µ–Ω
- `trial` - –ü—Ä–æ–±–Ω—ã–π –ø–µ—Ä–∏–æ–¥
- `blocked` - –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω (–Ω–∏–∑–∫–∏–π –±–∞–ª–∞–Ω—Å)
- `suspended` - –ü—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (–∞–¥–º–∏–Ω–æ–º)

### –°—Ç–∞—Ç—É—Å —Ä–µ–∑–µ—Ä–≤–∞ (Reservation)
- `hold` - –ó–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–æ
- `captured` - –ó–∞—á–∏—Å–ª–µ–Ω–æ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É
- `released` - –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–æ (–≤–æ–∑–≤—Ä–∞—Ç)
- `expired` - –ò—Å—Ç—ë–∫ —Å—Ä–æ–∫ —Ä–µ–∑–µ—Ä–≤–∞

### –°—Ç–∞—Ç—É—Å —Å—á—ë—Ç–∞ (Invoice)
- `draft` - –ß–µ—Ä–Ω–æ–≤–∏–∫
- `pending` - –û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã
- `paid` - –û–ø–ª–∞—á–µ–Ω
- `overdue` - –ü—Ä–æ—Å—Ä–æ—á–µ–Ω
- `cancelled` - –û—Ç–º–µ–Ω—ë–Ω

### –¢–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏ (Transaction)
- `subscription_charge` - –°–ø–∏—Å–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏
- `commission_reserve` - –†–µ–∑–µ—Ä–≤ –∫–æ–º–∏—Å—Å–∏–∏
- `commission_capture` - –ó–∞—á–∏—Å–ª–µ–Ω–∏–µ –∫–æ–º–∏—Å—Å–∏–∏
- `balance_topup` - –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
- `refund` - –í–æ–∑–≤—Ä–∞—Ç —Å—Ä–µ–¥—Å—Ç–≤
- `adjustment` - –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ (–∞–¥–º–∏–Ω)

## API Endpoints (–∫—Ä–∞—Ç–∫–∏–π –æ–±–∑–æ—Ä)

### –ê–∫–∫–∞—É–Ω—Ç—ã
- `POST /api/v1/billing/accounts` - –°–æ–∑–¥–∞—Ç—å –±–∏–ª–ª–∏–Ω–≥-–∞–∫–∫–∞—É–Ω—Ç
- `GET /api/v1/billing/accounts/{kbAccountId}/balance` - –ë–∞–ª–∞–Ω—Å –∞–∫–∫–∞—É–Ω—Ç–∞

### –ü–æ–¥–ø–∏—Å–∫–∏
- `POST /api/v1/billing/subscriptions` - –°–æ–∑–¥–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫—É
- `PUT /api/v1/billing/subscriptions/{id}/cancel` - –û—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É

### –†–µ–∑–µ—Ä–≤—ã/–ö–æ–º–∏—Å—Å–∏–∏
- `POST /api/v1/billing/reservations` - –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–∏—Å—Å–∏—é
- `POST /api/v1/billing/reservations/{id}/capture` - –ó–∞—á–∏—Å–ª–∏—Ç—å –∫–æ–º–∏—Å—Å–∏—é
- `POST /api/v1/billing/reservations/{id}/release` - –û—Å–≤–æ–±–æ–¥–∏—Ç—å —Ä–µ–∑–µ—Ä–≤

### –°—á–µ—Ç–∞ –∏ –ø–ª–∞—Ç–µ–∂–∏
- `POST /api/v1/billing/invoices/create` - –°–æ–∑–¥–∞—Ç—å —Å—á—ë—Ç –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
- `POST /api/v1/billing/webhook/{psp}` - Webhook –æ—Ç –ø–ª–∞—Ç—ë–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã

### –î–æ–∫—É–º–µ–Ω—Ç—ã
- `GET /api/v1/billing/documents/{invoiceId}` - –ü–æ–ª—É—á–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç (PDF)
- `GET /api/v1/billing/reports/avr/{period}` - –ê–í–† –∑–∞ –ø–µ—Ä–∏–æ–¥

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Kill Bill
- Java 11+
- PostgreSQL 12+
- Docker & Docker Compose
- REST API (Jackson, JAX-RS)

### Coube Integration Layer
- Spring Boot 3.x
- Spring Data JPA
- Spring WebClient (–¥–ª—è –≤—ã–∑–æ–≤–æ–≤ Kill Bill API)
- PostgreSQL (–æ—Ç–¥–µ–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ `billing`)
- Docker (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è)

### –ü–ª–∞—Ç—ë–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã (Phase 2)
- BCC (–ø–µ—Ä–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
- Jusan
- Kaspi
- Webhook –æ–±—Ä–∞–±–æ—Ç–∫–∞

## –≠—Ç–∞–ø—ã –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### Phase 1: MVP (Kill Bill + –±–∞–∑–æ–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)
1. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Kill Bill –≤ Docker
2. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ö–µ–º—ã `billing` –≤ Coube DB
3. ‚úÖ API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Platform ‚Üî Kill Bill
4. ‚úÖ –†—É—á–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–ø–ª–∞—Ç—ã –∞–¥–º–∏–Ω–æ–º
5. ‚úÖ –ë–∞–∑–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ (—Å—á–µ—Ç–∞)

### Phase 2: –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
1. ‚è≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å BCC (webhook)
2. ‚è≥ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –¥–∂–æ–±—ã (–∞–º–æ—Ä—Ç–∏–∑–∞—Ü–∏—è, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
3. ‚è≥ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ê–í–†
4. ‚è≥ –°–∏—Å—Ç–µ–º–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (email, SMS, push)

### Phase 3: –ü—Ä–æ–¥–∞–∫—à–Ω
1. ‚è≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Å—Ç–∞–ª—å–Ω—ã–º–∏ PSP
2. ‚è≥ –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î
3. ‚è≥ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç–∏–Ω–≥
4. ‚è≥ –ù–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
5. ‚è≥ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API (Swagger)

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- **mTLS** –¥–ª—è Platform ‚Üî Kill Bill
- **JWT —Ç–æ–∫–µ–Ω—ã** –¥–ª—è API –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **–ü–æ–¥–ø–∏—Å—å webhook** –æ—Ç PSP (HMAC SHA256)
- **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π**
- **–ê—É–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π** (created_by, updated_by)

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

- **Healthcheck** –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ Kill Bill
- **–ú–µ—Ç—Ä–∏–∫–∏** —É—Å–ø–µ—à–Ω–æ—Å—Ç–∏ –ø–ª–∞—Ç–µ–∂–µ–π
- **–ê–ª–µ—Ä—Ç—ã** –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–∫–∞—Ö
- **–û—Ç—á—ë—Ç—ã** –ø–æ –±–∞–ª–∞–Ω—Å–∞–º –∏ –∫–æ–º–∏—Å—Å–∏—è–º

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ —Ä–µ—Å—É—Ä—Å—ã

- **Kill Bill Docs**: https://docs.killbill.io/
- **Kill Bill GitHub**: https://github.com/killbill/killbill
- **Kill Bill API**: https://killbill.github.io/slate/
- **Swagger UI**: http://localhost:8080/api/killbill/1.0/kb/swagger.json

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥**: –ü–µ—Ä–µ–π—Ç–∏ –∫ `00-SUMMARY.md` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø–ª–∞–Ω–∞.
