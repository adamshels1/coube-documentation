# –°–≤–æ–¥–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∫—É—Ä—å–µ—Ä—Å–∫–æ–π –¥–æ—Å—Ç–∞–≤–∫–∏ MVP
## –î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: 2025-10-24

## üìã –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. ‚ùå –£–¥–∞–ª–µ–Ω–æ –ø–æ–ª–µ `teezPostId`
- **–ë—ã–ª–æ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –¥–≤–∞ –ø–æ–ª—è - `externalId` –∏ `teezPostId`
- **–°—Ç–∞–ª–æ**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ `externalId` –¥–ª—è –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º
- **–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ —Ñ–∞–π–ª—ã**: API –ø—Ä–∏–º–µ—Ä—ã, DTO, —Å–µ—Ä–≤–∏—Å—ã

### 2. üîë –ò–∑–º–µ–Ω–µ–Ω–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞—è–≤–æ–∫
- **–ë—ã–ª–æ**: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –ø–æ `externalWaybillId`
- **–°—Ç–∞–ª–æ**: –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –∫–ª—é—á—É:
  - `externalWaybillId` + `sourceSystem` + `orgId`
- **–ü—Ä–∏—á–∏–Ω–∞**: –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∑–∞—è–≤–∫–∏ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ —Ä–∞–º–∫–∞—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- **–ù–æ–≤–æ–µ –ø–æ–ª–µ**: –î–æ–±–∞–≤–ª–µ–Ω–æ `orgId` –≤ —Ç–∞–±–ª–∏—Ü—É `transportation`

### 3. üîÑ –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–æ –ø–æ–ª–µ —Å–∫–ª–∞–¥–∞
- **–ë—ã–ª–æ**: `responsibleWarehouseId` –∏–ª–∏ `responsible_courier_warehouse_id`
- **–°—Ç–∞–ª–æ**: `warehouseExternalId`
- **–§–æ—Ä–º–∞—Ç**: camelCase –≤–æ –≤—Å–µ—Ö –ø–æ–ª—è—Ö API

### 4. üê´ –í—Å–µ –ø–æ–ª—è API –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∫ camelCase
- **–ü—Ä–∏–º–µ—Ä—ã –∏–∑–º–µ–Ω–µ–Ω–∏–π**:
  - `delivery_type` ‚Üí `deliveryType`
  - `is_sms_required` ‚Üí `isSmsRequired`
  - `position_code` ‚Üí `positionCode`
  - `track_number` ‚Üí `trackNumber`

### 5. ‚ûï –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ —Ä–µ–∏–º–ø–æ—Ä—Ç–∞
- **Endpoint**: `POST /api/v1/integration/waybills/reimport`
- **–ö—Ç–æ –≤—ã–∑—ã–≤–∞–µ—Ç**: –í–Ω–µ—à–Ω—è—è —Å–∏—Å—Ç–µ–º–∞ TEEZ (—á–µ—Ä–µ–∑ API Key)
- **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç**: –ü–æ–ª–Ω–∞—è –∑–∞–º–µ–Ω–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–Ω–æ–≥–æ –ª–∏—Å—Ç–∞
- **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è**:
  - –¢–æ–ª—å–∫–æ –¥–ª—è –º–∞—Ä—à—Ä—É—Ç–æ–≤ –≤ —Å—Ç–∞—Ç—É—Å–µ IMPORTED
  - –î–æ –ª—é–±—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ UI
  - –¢–æ–ª—å–∫–æ –∏–∑ —Ç–æ–π –∂–µ —Å–∏—Å—Ç–µ–º—ã-–∏—Å—Ç–æ—á–Ω–∏–∫–∞
- **–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –ü–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ `externalWaybillId + sourceSystem + orgId`

**‚ùó –í–ê–ñ–ù–û**: –≠—Ç–æ –ù–ï —Ç–æ –∂–µ —Å–∞–º–æ–µ, —á—Ç–æ `PUT /api/v1/courier/waybills/{id}` –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–≥–∏—Å—Ç–æ–º!

### 6. üìù –û–±–Ω–æ–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
- **–ü–æ–ª–µ**: `responsibleManagerContactInfo`
- **–î–ª—è TEEZ**: –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ
- **–î–ª—è –¥—Ä—É–≥–∏—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤**: –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ
- **–í–∞–ª–∏–¥–∞—Ü–∏—è**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ `CourierIntegrationService.importWaybill()`

## üìÅ –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. **01-mvp-plan.md**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `orgId` –≤ Transportation entity
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è –ë–î —Å —Å–æ—Å—Ç–∞–≤–Ω—ã–º –∏–Ω–¥–µ–∫—Å–æ–º
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `reimportWaybill()` –≤ CourierIntegrationService
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è responsibleManagerContactInfo

### 2. **02-implementation-checklist.md**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `org_id` –≤ –º–∏–≥—Ä–∞—Ü–∏—é
- ‚úÖ –°–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å –Ω–∞ `external_waybill_id + source_system + org_id`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ —Ä–µ–∏–º–ø–æ—Ä—Ç–∞ –≤ —Å–µ—Ä–≤–∏—Å –∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ç–µ—Å—Ç—ã –¥–ª—è —Ä–µ–∏–º–ø–æ—Ä—Ç–∞
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è TEEZ

### 3. **03-api-examples.md**
- ‚úÖ –í—Å–µ –ø–æ–ª—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω—ã –≤ camelCase
- ‚úÖ –£–±—Ä–∞–Ω–æ –ø–æ–ª–µ `teezPostId` –∏–∑ –ø—Ä–∏–º–µ—Ä–æ–≤
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–∏–º–µ—Ä –º–µ—Ç–æ–¥–∞ —Ä–µ–∏–º–ø–æ—Ä—Ç–∞ (—Ä–∞–∑–¥–µ–ª 1.1)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `orgId` –≤–æ –≤—Å–µ –ø—Ä–∏–º–µ—Ä—ã
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ –ø–æ–ª–µ `warehouseExternalId`

## üîÑ –ú–∏–≥—Ä–∞—Ü–∏—è –ë–î

### –ù–æ–≤—ã–µ –ø–æ–ª—è –≤ `transportation`:
```sql
ALTER TABLE applications.transportation
ADD COLUMN IF NOT EXISTS org_id TEXT;

-- –°–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å –¥–ª—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
CREATE INDEX IF NOT EXISTS idx_transportation_external_waybill
ON applications.transportation(external_waybill_id, source_system, org_id)
WHERE transportation_type = 'COURIER_DELIVERY';
```

## üß™ –ù–æ–≤—ã–µ —Ç–µ—Å—Ç—ã

### CourierIntegrationServiceTest:
- –¢–µ—Å—Ç –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–º—É –∫–ª—é—á—É
- –¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ —Ä–µ–∏–º–ø–æ—Ä—Ç–∞ IMPORTED —Å—Ç–∞—Ç—É—Å–∞
- –¢–µ—Å—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Ä–µ–∏–º–ø–æ—Ä—Ç–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –∏–∑ UI
- –¢–µ—Å—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —Ä–µ–∏–º–ø–æ—Ä—Ç–∞ –∏–∑ –¥—Ä—É–≥–æ–π —Å–∏—Å—Ç–µ–º—ã
- –¢–µ—Å—Ç –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—è responsibleManagerContactInfo –¥–ª—è TEEZ

### CourierIntegrationControllerIT:
- –¢–µ—Å—Ç POST /waybills/reimport —Å –≤–∞–ª–∏–¥–Ω—ã–º payload
- –¢–µ—Å—Ç –≤–æ–∑–≤—Ä–∞—Ç–∞ 403 Forbidden –ø—Ä–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ —Ä–µ–∏–º–ø–æ—Ä—Ç–∞

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

1. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –°—Ç–∞—Ä—ã–µ –∑–∞–ø–∏—Å–∏ –±–µ–∑ `orgId` –º–æ–≥—É—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞**: –ü—Ä–∏ —Ä–µ–∏–º–ø–æ—Ä—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ `sourceSystem`
3. **–°–æ—Å—Ç–∞–≤–Ω–æ–π –∫–ª—é—á**: –ü—Ä–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö –ø–æ–∏—Å–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π –∫–ª—é—á
4. **TEEZ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å**: –ü–æ–º–Ω–∏—Ç—å –æ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ `responsibleManagerContactInfo` —Ç–æ–ª—å–∫–æ –¥–ª—è TEEZ

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–º –∏ –æ—Ç—Ä–∞–∂–µ–Ω—ã –≤ –æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–º –¥–æ–∫—É–º–µ–Ω—Ç–µ `–ü—Ä–æ–µ–∫—Ç —Ä–µ—à–µ–Ω–∏—è Coube-Teez_v2.md`