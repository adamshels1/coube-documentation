**ТЗ для БЭКЕНДА**

**Общие требования**

- Все запросы к страховой проходят через защищённый REST API, описанный
  в их ТЗ.

- Все статусы должны логироваться и отображаться на фронте.

**API флоу (пошагово)**

**1. Запрос на проверку клиента (санкционные списки)**

![cid:image001.png@01DB3036.4F08B6E0](media/image1.png){width="6.496527777777778in"
height="2.3229166666666665in"}

**Действие:**  
Бэк вызывает API страховой:

# Метод CheckClient: террористы/санкционные списки  {#метод-checkclient-террористысанкционные-списки}

Проверки ПОДФТ подключать на этапе формирования запроса на страхование

| **Метод CheckClient** |              |
|-----------------------|--------------|
| **Параметр**          | **Тип поля** |
| IDNumber              | string       |
| Name                  | string       |
| LastName              | string       |
| FirstName             | string       |
| MiddleName            | string       |

**Сервис:** <https://ws.theeurasia.kz/ws/wsNovelty.1cws>

\<xs:element name=\"CheckClient\"\>

\<xs:complexType\>

\<xs:sequence\>

\<xs:element name=\"IDNumber\" type=\"xs:string\" nillable=\"true\"/\>

\<xs:element name=\"Name\" type=\"xs:string\" nillable=\"true\"/\>

\<xs:element name=\"LastName\" type=\"xs:string\" nillable=\"true\"/\>

\<xs:element name=\"FirstName\" type=\"xs:string\" nillable=\"true\"/\>

\<xs:element name=\"MiddleName\" type=\"xs:string\" nillable=\"true\"/\>

\</xs:sequence\>

\</xs:complexType\>

\</xs:element\>

Если возвращается 0, запрос отработал корректно 200 ОК -- продолжается
флоу к ознакомлению с документами, если 1, то найдено совпадение в
списке ПОДФТ -- отражаем отказ от страхования.

**2. Подпись ЭЦП**

**Endpoint:** POST /insurance/sign  
Поля:

{

\"user_id\": \"uuid\",

\"signature_data\": \"\...\",

\"signed_at\": \"timestamp\"

}

**Бэк:** сохраняет подпись и данные подписанта + серийный номер
сертификата в таблицу insurance_signatures.

**3. Создание нового документа в страховой**

**Endpoint:** POST /insurance/create

метод CreateNewDocument

Body: {

\"policyAmount\": \<сумма\>,

\"currency\": \<валюта\>,

\"inn\": \<ИНН\>,

\"signerData\": {\...},

\"directorData\": {\...}

}

Ответ:

{

\"status\": \"ok\",

\"contractNumber\": \"ST-2025-012345\"

}

**5. Передача подписанных файлов (XML + картинки)**

Отправляет через API страховой по номеру договора + данные перевозки из
справочника (см. ТЗ от страховой):

## Методом SavePicture платформа передает: {#методом-savepicture-платформа-передает .unnumbered}

- Заявление -анкету, подписанную ЭЦП клиента

- Договор страхования, подписанный ЭЦП клиента

- Доверенность подписанта клиента (если страхователь юр лицо)

- Документ, подтверждающий статус ИП (если страхователь ИП/КХ)

- Сопутствующие документы в целях надлежащей проверки в рамках закона
  ПОД/ФТ

  - Справка о зарегистрированном юридическом лице

  - Удостоверение первого руководителя

  - Документ, удостоверяющий личность бенефициарного собственника

  - Документ, удостоверяющий личность подписана по договору от клиента

  - Доверенность подписанта от клиента (если от юр лица подписывает
    представитель по доверенности)

}

# Метод SavePicture {#метод-savepicture .unnumbered}

#  {#section .unnumbered}

Коды документов для передачи методом

Использовать метод для загрузки документов по клиенту.

|                                               |       |
|-----------------------------------------------|-------|
| Наименование                                  | Код   |
| Банковские реквизиты                          | 00064 |
| Государственная лицензия                      | 00009 |
| Доверенность                                  | 00026 |
| Договор                                       | 00060 |
| Договор подписаный ЭЦП                        | 00085 |
| Договор ЭЦП                                   | 00231 |
| Документ государственной регистрации ИП       | 00003 |
| Документ государственной регистрации ЮЛ       | 00005 |
| Документ на право подписи от имени ЮЛ         | 00004 |
| Документ, удостоверяющий личность             | 00001 |
| Документ, удостоверяющий регистрацию в РК     | 00002 |
| Заявление, подписанное ЭЦП                    | 00086 |
| Карточка документа ЭЦП                        | 00226 |
| Миграционная карта/visa/ отметка (печать)     | 00063 |
| Миграционная карточка                         | 00011 |
| Регистрационная карточка нерезидента          | 00013 |
| Свидетельство о регистрации                   | 00012 |
| Справка о зарегистрированном юридическом лице | 00061 |
| Справка о наличии счета                       | 00333 |
| Удостоверение личности первого руководителя   | 00010 |
| Удостоверения личности учредителей либо устав | 00007 |
| Учредительные документы                       | 00006 |

| **Параметр**   | **Тип поля** |
|----------------|--------------|
| ID             | int          |
| DestinationID  | string       |
| ClientName     | string       |
| ClientID       | string       |
| ObjectName     | string       |
| DocumentXML    | base64Binary |
| ContractNumber | string       |
| FileName       | string       |
| CRC32          | int          |

\<xs:element name=\"SavePicture\"\>

\<xs:complexType\>

\<xs:sequence\>

\<xs:element name=\"ID\" type=\"xs:int\"/\>

\<xs:element name=\"DestinationID\" type=\"xs:string\"/\>

\<xs:element name=\"ClientName\" type=\"xs:string\"/\>

\<xs:element name=\"ClientID\" type=\"xs:string\" nillable=\"true\"/\>

\<xs:element name=\"ObjectName\" type=\"xs:string\"/\>

\<xs:element name=\"DocumentXML\" type=\"xs:base64Binary\"/\>

\<xs:element name=\"ContractNumber\" type=\"xs:string\" nillable=\"true\"/\>

\<xs:element name=\"FileName\" type=\"xs:string\"/\>

\<xs:element name=\"CRC32\" type=\"xs:int\" nillable=\"true\"/\>

\</xs:sequence\>

\</xs:complexType\>

\</xs:element\>

| **Параметр**   | **Тип поля** |
|----------------|--------------|
| ID             | int          |
| DestinationID  | string       |
| ClientName     | string       |
| ClientID       | string       |
| ObjectName     | string       |
| DocumentXML    | base64Binary |
| ContractNumber | string       |
| FileName       | string       |
| CRC32          | int          |

\<xs:element name=\"SavePicture\"\>

\<xs:complexType\>

\<xs:sequence\>

\<xs:element name=\"ID\" type=\"xs:int\"/\>

\<xs:element name=\"DestinationID\" type=\"xs:string\"/\>

\<xs:element name=\"ClientName\" type=\"xs:string\"/\>

\<xs:element name=\"ClientID\" type=\"xs:string\" nillable=\"true\"/\>

\<xs:element name=\"ObjectName\" type=\"xs:string\"/\>

\<xs:element name=\"DocumentXML\" type=\"xs:base64Binary\"/\>

\<xs:element name=\"ContractNumber\" type=\"xs:string\" nillable=\"true\"/\>

\<xs:element name=\"FileName\" type=\"xs:string\"/\>

\<xs:element name=\"CRC32\" type=\"xs:int\" nillable=\"true\"/\>

\</xs:sequence\>

\</xs:complexType\>

\</xs:element\>

**6. Получение подписанного договора**

**Endpoint:** GET /insurance/contract/:number  
Вызывает API страховой → получает PDF и сохраняет  
Ответ фронту:

{

\"status\": \"ok\",

\"contractNumber\": \"ST-2025-012345\",

\"pdfUrl\": \"https://cdn.yourplatform.ru/contracts/ST-2025-012345.pdf\"

}

Отражает в ЛК «Мои документы»
