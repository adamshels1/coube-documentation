**ТЗ по отчетам онлайн-платформы грузоперевозок**

**1\. Реестр заявок и перевозок (сквозной) - этот реестр долженбыть также в блоке фин документов и формироваться с как приложение к АВР**

**Excel / Таблица**  
| № заявки | № рейса | Перевозчик | Груз | Вес (т) | Откуда | Куда | Статус | Дата создания | Дата исполнения | Стоимость (₽) | Пробег (км) |

| **Поле** | **Тип** | **Описание** | **Единицы** |
| --- | --- | --- | --- |
| № заявки | string | Уникальный ID заявки | -   |
| № рейса | string | Уникальный ID рейса | -   |
| Перевозчик | string | Название компании-перевозчика | -   |
| Груз | string | Наименование груза | -   |
| Вес | float | Вес груза | т   |
| Маршрут | string | Откуда → Куда | -   |
| Статус | enum | Новый / В пути / Завершен / Отменен | - реестр это факт уже - тут статус только завершен |
| Дата создания | datetime | Дата создания заявки | -   |
| Дата исполнения | datetime | Фактическая дата завершения | -   |
| Стоимость | float | Стоимость перевозки | Т   |
| Пробег | float | Расстояние маршрута | км  |

**UI-дизайн**

- Таблица с цветовым кодом статуса:
    - Новая (серый), В пути (синий), Завершена (зеленый), Отмена (красный).
- Фильтры сверху (даты, перевозчик, статус). Фиксированная шапка таблицы при скролле.

**Фронт:**

- Фильтры: период, статус заявки, контрагент, маршрут, вид груза.
- Таблица с колонками: ID заявки, номер рейса, заказчик, перевозчик, груз, вес, маршрут (откуда/куда), статус, дата создания, дата исполнения, стоимость.
- Экспорт в Excel.

**Бек:**

- SQL-запрос с JOIN (заявки + перевозки + пользователи).
- Агрегация по периоду.
- Обновление: в реальном времени при изменении статуса заявки.

**Формулы/единицы:**

- Стоимость - сумма по договору (₽).
- Вес груза (тонны).
- Пробег маршрута (км).

**2\. Выполненные перевозки (закрывающие документы)**

**Excel / Таблица**  
| № перевозки | Перевозчик | Сумма (₽) | АВР (ссылка) | Страховой полис | Премия | Статус документа |

| **Поле** | **Тип** | **Описание** | **Единицы** |
| --- | --- | --- | --- |
| № перевозки | string | ID рейса | -   |
| Перевозчик | string | Название компании | -   |
| Сумма | float | Сумма по АВР | Т   |
| АВР | string | Ссылка на акт выполненных работ | -   |
| Страховой полис | string | Номер / ссылка | -   |
| Премия | float | Доп. премия по перевозке | Т   |
| Статус документа | enum | Подписан / В ожидании / Отклонен | -   |

**UI-дизайн**

- Таблица .
- Статусы документов цветом (подписан, в ожидании подписи, отклонен).

**Фронт:**

- Таблица: ID перевозки, заказчик, перевозчик, сумма, ссылка на АВР, ссылка на страховой полис, статус документа.
- Возможность скачать PDF/сканы.

**Бек:**

- Отчет формируется по завершенным перевозкам.

**Формулы:**

- Итоговая сумма = сумма АВР.

**3\. Финансовый отчет (оплаты) - отчет будет активным при подключении платежной системы позже - пока в разработке оставить**

**Excel / Таблица**  
| № платежа | Перевозка | Сумма () | Дата оплаты | Статус | Метод оплаты |

| **Поле** | **Тип** | **Описание** | **Единицы** |
| --- | --- | --- | --- |
| № платежа | string | ID платежа | -   |
| Перевозка | string | ID рейса | -   |
| Сумма | float | Сумма платежа | Т   |
| Дата платежа | datetime | Дата проведения | -   |
| Статус | enum | Оплачен / В ожидании / Просрочен | -   |
| Метод оплаты | string | Нал / Безнал / Онлайн | -   |

**Фронт:**

- Таблица: ID платежа, перевозка, сумма, дата платежа, способ оплаты.
- Фильтры: по датам, статусу оплаты.
- Диаграмма - динамика оплат по месяцам.

**Бек:**

- Подтягивание данных из платежного модуля.
- Агрегация по месяцам/кварталам.

**Формулы:**

- Общая сумма оплат = SUM(платежи).

**Дизайн:**

- Таблица + график (столбцы по месяцам).
- Цвет для статусов: оплачен - зеленый, ожидается - желтый, просрочен - красный.

**4\. Дебиторка (статусы погашения) отчет будет активным при подключении платежной системы позже - пока в разработке оставить**

**Excel / Таблица**  
| Заказчик | Сумма долга () | Дата платежа | Срок оплаты | Статус (в срок/просрочка) | Просрочка (дни) |

| **Поле** | **Тип** | **Описание** | **Единицы** |
| --- | --- | --- | --- |
| Заказчик | string | Название вашей компании | -   |
| Перевозка | string | ID рейса | -   |
| Сумма долга | float | Остаток к оплате | Т   |
| Срок оплаты | date | Дата, до которой нужно оплатить | -   |
| Статус погашения | enum | В срок / Просрочено | -   |
| Просрочка | int | Кол-во дней просрочки | дни |

**UI-дизайн**

- Таблица + пироговая диаграмма: оплачено / в срок / просрочено.
- Красная подсветка просроченных.

**Фронт:**

- Таблица: заказчик, перевозка, сумма долга, срок оплаты, статус.
- Фильтр по просрочке.
- Диаграмма: структура дебиторки (пирог).

**Бек:**

- Считается как "Сумма договора - оплачено".
- Обновление: раз в сутки + при изменении статуса платежа.

**Формулы:**

- Просрочка (дни) = (сегодня - срок оплаты).

**Дизайн:**

- Красная подсветка просроченных строк.
- Пирог с долями (оплачено / просрочено / в срок).

**5\. SLA / дедлайны / опоздания**

**Excel / Таблица**  
| № рейса | Плановое время | Фактическое время | Отклонение (часы) | Простой (часы) | SLA % |

| **Поле** | **Тип** | **Описание** | **Единицы** |
| --- | --- | --- | --- |
| № рейса | string | ID рейса | -   |
| Плановое время | datetime | Плановая дата и время прибытия | -   |
| Фактическое время | datetime | Фактическая дата и время прибытия | -   |
| Отклонение | float | Факт - План | часы |
| Простой | float | Время простоя на погрузке/выгрузке | часы |
| SLA % | float | % рейсов, выполненных вовремя | %   |

**Фронт:**

- Таблица: рейс, плановое время, фактическое, отклонение (часы/дни), простой на погрузке/выгрузке.
- График: план-факт по срокам.

**Бек:**

- Данные из GPS + статусы заявок.
- Обновление в реальном времени.

**Формулы:**

- Отклонение = факт - план.
- SLA % = (кол-во выполненных вовремя / общее кол-во) \* 100.

**Единицы:** часы, дни.

**Дизайн:**

- Таблица + диаграмма (столбцы: план/факт).
- Цвет: опоздание - красный, вовремя - зеленый.

**6\. Споры и претензии - отчет будет активным при подключении платежной системы позже - пока в разработке оставить**

**Excel / Таблица**  
| № спора | Перевозка | Сумма (₽) | Статус (новый/в рассмотрении/решен) | Результат | Комментарии |

| **Поле** | **Тип** | **Описание** | **Единицы** |
| --- | --- | --- | --- |
| № спора | string | Уникальный ID спора | -   |
| Перевозка | string | ID рейса | -   |
| Сумма претензии | float | ₽   | Т   |
| Статус | enum | Новый / В рассмотрении / Решен | -   |
| Результат | string | Решение по спору | -   |
| Отзыв | text | Текст отзыва | -   |

**Фронт:**

- Таблица: ID спора, заказчик, перевозчик, статус, сумма претензии, результат.
- Возможность загружать файлы доказательств.

**Бек:**

- Сервис управления претензиями.
- Хранение документов.

**Дизайн:**

- Канбан-доска (Новый → В рассмотрении → Решен).

**7\. Сравнение исполнителей (скоринг, цены)**

**Excel / Таблица**  
| Перевозчик | Средняя ставка (Т/т) | Рейтинг (звезды) | % SLA | Кол-во рейсов |

| **Поле** | **Тип** | **Описание** | **Единицы** |
| --- | --- | --- | --- |
| Перевозчик | string | Название компании | -   |
| Средняя ставка | float | Средняя ставка по рейсам | Т   |
| Рейтинг | float | Средний рейтинг исполнителя | 1-5 |
| % SLA | float | Процент рейсов, выполненных вовремя | %   |
| Кол-во рейсов | int | Всего рейсов | шт  |
| История цен | text / json | Динамика ставок | Т   |

**Фронт:**

- Диаграмма: динамика цен.

**Бек:**

- Скоринг: (время + отзывы + процент SLA).
- История ставок берется из заявок. Обновление постоянное

**Формулы:**

- Рейтинг = среднее значение отзывов.

**Дизайн:**

- Таблица + график (линия цен по месяцам).
- Звездочки для рейтинга.

**8\. Гео-аналитика маршрутов**

**Excel / Таблица**  
| № рейса | Груз (т) | Маршрут | Пробег (км) | Стоимость (Т) | Цена/т | Цена/т/км |

| **Поле** | **Тип** | **Описание** | **Единицы** |
| --- | --- | --- | --- |
| № рейса | string | ID рейса | -   |
| Маршрут | string | Откуда → Куда | -   |
| Пробег | float | Расстояние маршрута | км  |
| Груз | float | Вес груза | т   |
| Стоимость | float | Сумма рейса | Т   |
| Цена/т | float | Стоимость 1 тонны | Т   |
| Цена/т/км | float | Стоимость 1 тонны на 1 км | Т/т/км |

**Фронт:**

- Карта с маршрутами.
- Таблица: рейс, груз, тоннаж, стоимость за тонну, стоимость за км.

**Бек:**

- Использовать API карт (Google/Yandex).
- Автоматический расчет стоимости = сумма перевозки / тоннаж / км.

**Формулы:**

- Цена/т = сумма / тоннаж.
- Цена/т/км = сумма / тоннаж / расстояние.

**Дизайн:**

- Карта с линиями маршрутов.
- Всплывающие подсказки при наведении.

**9\. Логи подписей и ЭЦП добавить ПЭП**

**Excel / Таблица**  
| Документ | Подписал | Дата | Статус (подписан/ожидает/отклонен) |

| **Поле** | **Тип** | **Описание** | **Единицы** |
| --- | --- | --- | --- |
| Документ | string | Название документа | -   |
| Подписал | string | Кто подписал | -   |
| Дата | datetime | Дата подписи | -   |
| Статус | enum | Подписан / Ожидает / Отклонен | -   |

**Фронт:**

- Таблица: документ, дата подписи, кто подписал, статус.

**Бек:**

- Подключение к сервису ЭЦП+ ПЭП.
- Логирование в БД.

**Дизайн:**

- Журнал событий (список, статус цветом).

**10\. Подписки / комиссии платформы - отчет будет активным при подключении биллинга/платежной системы позже - пока в разработке оставить**

**только по самому заказчику**

**Excel / Таблица**  
| Дата | Операция | Комиссия (Т) | Тип подписки |

| **Поле** | **Тип** | **Описание** | **Единицы** |
| --- | --- | --- | --- |
| Дата | datetime | Дата списания | -   |
| Операция | string | Тип комиссии | -   |
| Сумма | float | Сумма | Т   |
| Тип подписки | string | Тип тарифного плана | -   |

**Фронт:**

- Таблица: дата, операция, сумма комиссии, подписка.

**Бек:**

- Автоматический расчет комиссий (% от сделки).

**Дизайн:**

- Таблица + график (сумма комиссий за период).

**11\. Логи уведомлений**

**Excel / Таблица**  
| Дата | Канал (Email/SMS/WhatsApp/Webhook) | Сообщение | Статус (доставлено/ошибка) |

| **Поле** | **Тип** | **Описание** | **Единицы** |
| --- | --- | --- | --- |
| Дата | datetime | Дата отправки уведомления | -   |
| Канал | enum | Email / SMS / WhatsApp / Webhook | -   |
| Сообщение | text | Текст уведомления | -   |
| Статус | enum | Доставлено / Ошибка | -   |

**Фронт:**

- Таблица: дата, канал (email/SMS/WhatsApp/webhook), статус доставки.

**Бек:**

- Интеграция с сервисами уведомлений.

**Дизайн:**

- Таблица + фильтры по каналам.

**12\. Количество рейсов / контракты**

**Excel / Таблица**  
| № рейса | Дата | Пробег (км) | Время ожидания (часы) | Контракт (да/нет) | Тип заявки (по контракту/разовая) |

| **Поле** | **Тип** | **Описание** | **Единицы** |
| --- | --- | --- | --- |
| № рейса | string | ID рейса | -   |
| Дата рейса | date | Дата рейса | -   |
| Пробег | float | Расстояние маршрута | км  |
| Время ожидания | float | Время ожидания погрузки/выгрузки | часы |
| Кол-во контрактов | int | Кол-во контрактов за период | шт  |
| Тип заявки | enum | По контракту / Без контракта | -   |

**Фронт:**

- Таблица: рейс, заказчик, перевозчик, пробег, время ожидания, контракт (да/нет).
- График: динамика по месяцам.

**Бек:**

- Данные из заказов + GPS.

**Формулы:**

- Время ожидания = выгрузка - прибытие.

**Дизайн:**

- Таблица + график (столбцы по месяцам).
